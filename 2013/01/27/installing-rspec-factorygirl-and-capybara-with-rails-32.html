<!DOCTYPE html>
<html lang='en' manifest='/offline.appcache'>
<head>
<meta charset='utf-8'>
<title>
Sascha Faun Winter
</title>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<meta content='Personal portfolio and blog of Sascha Faun Winter' name='description'>
<meta content='Sascha Faun Winter' name='author'>
<link href="/stylesheets/application.css" media="all" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:400,900" media="all" rel="stylesheet" type="text/css" />
<!-- [if lt IE 9] ><script src="/javascripts/html5.js" type="text/javascript"></script><! [endif] -->
<link href="/assets/ico/favicon.ico" rel="icon" type="image/ico" />
<link href='/assets/ico/apple-touch-icon-144x144-precomposed.png' rel='apple-touch-icon-precomposed' sizes='144x144'>
<link href='/assets/ico/apple-touch-icon-114x114-precomposed.png' rel='apple-touch-icon-precomposed' sizes='114x114'>
<link href='/assets/ico/apple-touch-icon-72x72-precomposed.png' rel='apple-touch-icon-precomposed' sizes='72x72'>
<link href='/assets/ico/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'>
<link href='https://plus.google.com/u/0/112681783906373636049' rel='author'>
</head>
<body>
<header class='navbar navbar-fixed-top navbar-inverse'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle navigation</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
</div>
<div class='container'>
<div class='navbar-inner'>
<nav class='collapse navbar-collapse'>
<ul class='nav navbar-nav'>
<li>
<a href="/">Home</a>
</li>
<li>
<a href="/resume.html">Resume</a>
</li>
<li>
<a href="/contact.html">Contact</a>
</li>
</ul>
</nav>
</div>
</div>
</header>

<div class='2013/01/27/installing-rspec-factorygirl-and-capybara-with-rails-32 container'>
<div class='row'>
<div class='container'>
<h1 class='page-title'>
Installing RSpec, FactoryGirl and Capybara with Rails 3.2
</h1>
<aside class='attribution'>
by
<a rel="me" href="https://twitter.com/faunzy">Sascha Faun Winter</a>
</aside>
<div class='section center-block'>
<article>
<h3>Generating a new Rails app without Test::Unit</h3>

<p>Let&rsquo;s get started. Begin by starting a new Rails project in the directory of your choice.</p>
<div class="highlight"><pre class="highlight plaintext"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rails new my_app -T
</pre></td></tr></tbody></table></code></pre></div>
<p>This will generate a new app without the <code>Test::Unit</code> directories as usually would accompany a new Rails project</p>

<h3>The Gemfile</h3>

<p>The first step to installing Rspec with Rails is to have a look at the <a href="https://github.com/rspec/rspec-rails">documentation</a>, which states you install it in both the test and development group.</p>

<p>In your Gemfile, put the following to install <a href="https://github.com/rspec/rspec-rails">rspec-rails</a>, <a href="https://github.com/jnicklas/capybara">Capybara</a>, and <a href="https://github.com/thoughtbot/factory_girl">FactoryGirl</a>.</p>
<div class="highlight"><pre class="highlight ruby"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span> <span class="s1">'~&gt; 3.2.11'</span>

<span class="c1">#...</span>

<span class="n">group</span> <span class="ss">:test</span><span class="p">,</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s2">"rspec-rails"</span><span class="p">,</span> <span class="s2">"~&gt; 2.0"</span>
  <span class="n">gem</span> <span class="s1">'capybara'</span><span class="p">,</span> <span class="s2">"~&gt; 2.0.2"</span>
  <span class="n">gem</span> <span class="s2">"factory_girl_rails"</span><span class="p">,</span> <span class="s2">"~&gt; 4.0"</span>
<span class="k">end</span>

<span class="c1">#...</span>
</pre></td></tr></tbody></table></code></pre></div>
<p>To install these gems, run:</p>
<div class="highlight"><pre class="highlight plaintext"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>bundle
</pre></td></tr></tbody></table></code></pre></div>
<h3>Install RSpec</h3>

<p>To install <code>rspec-rails</code> and tell Rails to use RSpec as the default testing framework instead of <code>Test::Unit</code>, run:</p>
<div class="highlight"><pre class="highlight plaintext"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rails generate rspec:install
</pre></td></tr></tbody></table></code></pre></div>
<h3>Configure the generators</h3>

<p>In <code>config/application.rb</code>, add the following code between the ellipses (surrounding code provided for context)</p>
<div class="highlight"><pre class="highlight ruby"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">module</span> <span class="nn">MyApp</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>

<span class="c1">#...</span>

    <span class="n">config</span><span class="p">.</span><span class="nf">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
      <span class="n">g</span><span class="p">.</span><span class="nf">test_framework</span> <span class="ss">:rspec</span><span class="p">,</span>
        <span class="ss">fixtures: </span><span class="kp">true</span><span class="p">,</span>
        <span class="ss">view_specs: </span><span class="kp">false</span><span class="p">,</span>
        <span class="ss">helper_specs: </span><span class="kp">false</span><span class="p">,</span>
        <span class="ss">routing_specs: </span><span class="kp">false</span><span class="p">,</span>
        <span class="ss">controller_specs: </span><span class="kp">true</span><span class="p">,</span>
        <span class="ss">request_specs: </span><span class="kp">true</span>
      <span class="n">g</span><span class="p">.</span><span class="nf">fixture_replacement</span> <span class="ss">:factory_girl</span><span class="p">,</span> <span class="ss">dir: </span><span class="s2">"spec/factories"</span>
    <span class="k">end</span>

<span class="c1">#...</span>

  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></div>
<p>This will ensure that when you run the Rails generators, (such as <code>rails g controller home</code>) the appropriate spec files will be generated as well.</p>

<h3>Using Capybara</h3>

<p>To use Capybara in your feature specs, all you need to do is require it from <code>spec/spec_helper.rb</code> (see line 5):</p>
<div class="highlight"><pre class="highlight ruby"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="no">ENV</span><span class="p">[</span><span class="s2">"RAILS_ENV"</span><span class="p">]</span> <span class="o">||=</span> <span class="s1">'test'</span>
<span class="nb">require</span> <span class="no">File</span><span class="p">.</span><span class="nf">expand_path</span><span class="p">(</span><span class="s2">"../../config/environment"</span><span class="p">,</span> <span class="kp">__FILE__</span><span class="p">)</span>
<span class="nb">require</span> <span class="s1">'rspec/rails'</span>
<span class="nb">require</span> <span class="s1">'rspec/autorun'</span>
<span class="nb">require</span> <span class="s1">'capybara/rspec'</span>

<span class="c1">#...</span>
</pre></td></tr></tbody></table></code></pre></div>
<p>As of Capybara 2.0, there is no configuration necessary to get access to the Capybara DSL (visit/page), given they are placed in the right location. See <a href="http://rubydoc.info/gems/rspec-rails/file/Capybara.md#Upgrading_to_Capybara-2_0">this page</a> for (slightly) more information. When you generate new feature tests, place them in <code>spec/features</code> to use Capybara DSL. Simple enough.</p>

<h3>FactoryGirl Definitions</h3>

<p>In addition to requiring Capybara, you will want to add an additional line to <code>spec/spec_helper.rb</code>:</p>
<div class="highlight"><pre class="highlight ruby"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="no">FactoryGirl</span><span class="p">.</span><span class="nf">find_definitions</span>
</pre></td></tr></tbody></table></code></pre></div>
<p>This ensures that the factories in <code>spec/factories</code> will be detected correctly and you can begin to use them without any further configuration.</p>

</article>
</div>
<hr>
<aside>
<nav>
<a class='btn btn-default' href='/'>‚ÜêBack</a>
</nav>
</aside>

</div>
</div>
</div>
<script src='https://code.jquery.com/jquery-2.1.1.min.js' type='text/javascript'></script>
<script src="/javascripts/application.js" type="text/javascript"></script>
<script>
  // Google analytics
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11110028-1']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https://ssl.google-analytics.com/ga.js');
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  // Appcache brute-force refresh
  if (window.applicationCache) {
    applicationCache.addEventListener('updateready', function() {
      window.location.reload();
    });
  }
</script>
</body>
</html>

